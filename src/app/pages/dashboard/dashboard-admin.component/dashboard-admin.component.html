<main class="table-container">
  <div class="row g-4">
    <!-- Table (children) -->
    <div class="col-12 col-lg-9">
      <app-dashboard
        [isEmbedded]="true"
        [parentCompetitions]="competitions()"
        [parentError]="loadError()"
        (childEditCompetition)="editCompetition($event)"
        (childDeleteCompetition)="openDeleteModal($event)"
      ></app-dashboard>
    </div>
    <!-- Form -->
    <div class="col-12 col-lg-3">
      <div
        class="card add-competition-card fade-in"
        [class.show]="formVisible()"
      >
        <div class="card-header add-competition-header">
          <h6 class="mb-0">Add Competition</h6>
        </div>
        <!-- Alerts -->
        @if(submitMessage()) {
        <div
          class="alert alert-success alert-dismissible fade show mx-auto my-3 w-75 text-center mb-0"
          role="alert"
        >
          {{ submitMessage() }}
        </div>
        } @if(submitError()) {
        <div
          class="alert alert-danger alert-dismissible fade show mx-auto my-3 w-75 text-center mb-0"
          role="alert"
        >
          {{ submitError() }}
        </div>
        }
        <div class="card-body">
          <form
            [formGroup]="dashboardAdminForm"
            (ngSubmit)="submitDashboardAdminForm()"
          >
            <!-- Title -->
            <div class="mb-3 position-relative">
              <label for="title" class="form-label">Title</label>
              <input
                type="text"
                id="title"
                placeholder="Enter the title"
                class="form-control square-input"
                formControlName="title"
              />
              @if(hasError('title','required')) {
              <div class="input-error-bubble" aria-live="polite">
                Please fill out this field.
              </div>
              } @if(hasError('title','minlength')) {
              <div class="input-error-bubble" aria-live="polite">
                This field can't be more than 100 characters.
              </div>
              }
            </div>
            <!-- Description -->
            <div class="mb-3 position-relative">
              <label for="description" class="form-label">Description</label>
              <textarea
                id="description"
                rows="3"
                placeholder="Enter the description"
                class="form-control square-input"
                formControlName="description"
              ></textarea>
              @if(hasError('description','required')) {
              <div class="input-error-bubble" aria-live="polite">
                Please fill out this field.
              </div>
              } @if(hasError('description','minlength')) {
              <div class="input-error-bubble" aria-live="polite">
                This field can't be more than 500 characters.
              </div>
              }
            </div>
            <!-- Start date -->
            <div class="mb-3 position-relative">
              <label for="startDate" class="form-label">Start date</label>
              <input
                type="date"
                id="startDate"
                class="form-control square-input"
                formControlName="startDate"
              />
              @if(hasError('startDate','required')) {
              <div class="input-error-bubble" aria-live="polite">
                Please fill out this field.
              </div>
              } @if(hasError('startDate','invalidDate')) {
              <div class="input-error-bubble" aria-live="polite">
                This field must be a valid date.
              </div>
              }
            </div>
            <!-- End date -->
            <div class="mb-3 position-relative">
              <label for="endDate" class="form-label">End date</label>
              <input
                type="date"
                id="endDate"
                class="form-control square-input"
                formControlName="endDate"
              />
              @if(hasError('endDate','required')) {
              <div class="input-error-bubble" aria-live="polite">
                Please fill out this field.
              </div>
              } @if(hasError('endDate','invalidDate')) {
              <div class="input-error-bubble" aria-live="polite">
                This field must be a valid date.
              </div>
              }
            </div>
            <!-- Status -->
            <div class="mb-3">
              <label for="status" class="form-label">Status</label>
              <select
                id="status"
                class="form-select square-input"
                formControlName="status"
              >
                <option value="Ongoing">Ongoing</option>
                <option value="Completed">Completed</option>
                <option value="Upcoming">Upcoming</option>
              </select>
            </div>
            <!-- Buttons -->
            <div class="d-grid gap-2">
              <button
                type="submit"
                class="btn table-icon-btn btn-success"
                [disabled]="dashboardAdminForm.invalid"
              >
                {{ competition() ? "Save edit" : "Save" }}
              </button>
              <button
                type="reset"
                class="btn table-icon-btn btn-danger"
                (click)="clear()"
              >
                Clear
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</main>
<!-- Delete modal -->
<div
  class="delete-modal"
  [class.show]="isDeleteModalVisible()"
  (click)="onBackdropClick($event)"
  role="dialog"
  aria-modal="true"
  aria-labelledby="modalTitle"
>
  <div class="delete-modal-content" (click)="$event.stopPropagation()">
    <div class="delete-modal-header">
      <h5 class="modal-title" id="modalTitle">Confirm deletion</h5>
    </div>
    <div class="delete-modal-body">
      Are you sure you want to delete
      <strong>{{ competition()?.title }}</strong> competition?
    </div>
    <div class="delete-modal-footer">
      <button
        type="button"
        class="modal-btn modal-btn-dark"
        (click)="closeDeleteModal()"
      >
        Cancel
      </button>
      <button
        type="button"
        class="modal-btn modal-btn-danger"
        (click)="confirmDelete()"
      >
        Delete
      </button>
    </div>
  </div>
</div>
